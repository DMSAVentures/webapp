@use "@/proto-design-system/mixins" as *;

// Loading animation
@keyframes spin {
	from {
		transform: rotate(0deg);
	}

	to {
		transform: rotate(360deg);
	}
}

.spin {
	animation: spin 1s linear infinite;
}

.loading {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 100%;
	min-height: 400px;
}

.page {
	display: flex;
	flex-direction: column;
	gap: var(--space-5);
	padding: var(--space-5);
	height: 100%;
	min-height: 0;
}

.pageHeader {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	gap: var(--space-4);
	flex-shrink: 0;
}

// Configuration bar
.configBar {
	padding: var(--space-4);
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	flex-shrink: 0;
}

.configField {
	flex: 1;
	min-width: 200px;
}

// Builder layout (3-column)
.builder {
	display: grid;
	grid-template-columns: 260px 1fr 320px;
	grid-template-rows: 1fr;
	gap: var(--space-3);
	flex: 1;
	min-height: 0;
	overflow: hidden;
}

// Panels
.leftPanel,
.rightPanel {
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	overflow-y: auto;
	min-height: 0;
}

.centerPanel {
	display: flex;
	flex-direction: column;
	gap: var(--space-3);
	overflow-y: auto;
	min-height: 0;
}

.rightPanel {
	display: flex;
	flex-direction: column;
	overflow: hidden;
}

// Panel mode toggle
.panelModeToggle {
	padding: var(--space-3);
	border-bottom: 1px solid var(--color-border);
	flex-shrink: 0;
}

// Subject editor
.subjectEditor {
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	padding: var(--space-3);
}

// Canvas wrapper
.canvasWrapper {
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	overflow: hidden;
}

.canvasHeader {
	display: flex;
	align-items: center;
	gap: var(--space-1);
	padding: var(--space-2) var(--space-3);
	background-color: var(--color-base-100);
	border-bottom: 1px solid var(--color-border);
}

.blockCount {
	margin-left: auto;
}

.canvas {
	display: flex;
	flex-direction: column;
	gap: var(--space-1);
	padding: var(--space-3);
}

.emptyCanvas {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: var(--space-3);
	padding: var(--space-8);
	text-align: center;
	border: 2px dashed var(--color-border);
	border-radius: var(--radius-md);
	margin: var(--space-2);
	background-color: oklch(from var(--color-info) l c h / 0.03);
}

// Preview section
.previewWrapper {
	display: flex;
	flex-direction: column;
	flex: 1;
	min-height: 300px;
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	overflow: hidden;
}

.previewHeader {
	display: flex;
	align-items: center;
	gap: var(--space-1);
	padding: var(--space-2) var(--space-3);
	background-color: var(--color-base-100);
	border-bottom: 1px solid var(--color-border);
}

.emailPreview {
	display: flex;
	flex-direction: column;
	margin: var(--space-3) auto;
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	overflow: hidden;
	box-shadow: var(--color-shadow-elevated);
	transition: width var(--duration-normal) var(--ease-out);

	&.device_desktop {
		width: 100%;
		max-width: 600px;
	}

	&.device_tablet {
		width: 480px;
	}

	&.device_mobile {
		width: 360px;
	}
}

.emailHeader {
	display: flex;
	flex-direction: column;
	gap: var(--space-1);
	padding: var(--space-2) var(--space-3);
	border-bottom: 1px solid var(--color-border);
	background-color: var(--color-base-100);
}

.emailHeaderRow {
	display: flex;
	align-items: center;
	gap: var(--space-1);
}

.emailLabel {
	font-size: var(--font-size-sm);
	font-weight: var(--font-weight-medium);
	color: var(--color-base-content-secondary);
	min-width: 60px;
}

.emailValue {
	font-size: var(--font-size-sm);
	color: var(--color-base-content);
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.emailBody {
	flex: 1;
	min-height: 300px;
	background-color: var(--color-base-100);
}

.emailIframe {
	width: 100%;
	height: 100%;
	min-height: 300px;
	border: none;
	background-color: var(--color-white);
}

// No selection state
.noSelection {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: var(--space-3);
	height: 100%;
	padding: var(--space-6);
	text-align: center;
	background-color: var(--color-base-100);
	margin: var(--space-4);
	border-radius: var(--radius-md);
}

// Select campaign prompt
.selectCampaignPrompt {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: var(--space-3);
	flex: 1;
	padding: var(--space-8);
	text-align: center;
	background-color: var(--color-surface);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
}

// Responsive adjustments
@media (width <= 1440px) {
	.builder {
		grid-template-columns: 240px 1fr 300px;
	}
}

@media (width <= 1280px) {
	.builder {
		grid-template-columns: 220px 1fr 280px;
	}
}

@include breakpoint-down(lg) {
	.builder {
		grid-template-columns: 1fr;
		grid-template-rows: auto 1fr auto;
	}

	.leftPanel,
	.rightPanel {
		max-height: 300px;
	}

	.pageHeader {
		flex-direction: column;
		align-items: stretch;
		gap: var(--space-3);
	}

	.configBar {
		overflow-x: auto;
	}
}

@include breakpoint-down(md) {
	.page {
		padding: var(--space-3);
		gap: var(--space-3);
	}

	.configField {
		min-width: 150px;
	}

	.builder {
		gap: var(--space-2);
	}

	.leftPanel,
	.rightPanel {
		max-height: 250px;
	}

	.emailPreview {
		&.device_desktop,
		&.device_tablet {
			width: 100%;
		}
	}
}
