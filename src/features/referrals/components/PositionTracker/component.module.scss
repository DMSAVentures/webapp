@use "@/proto-design-system/mixins" as *;

.root {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    overflow: hidden;
}

.container {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-5);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    transition: all var(--duration-normal) var(--ease-out);

    @include breakpoint-down(md) {
        padding: var(--space-4);
    }
}

// Confetti Animation
.confettiContainer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 10;
}

.confetti {
    position: absolute;
    width: var(--space-2);  // 8px, close to 10px
    height: var(--space-2);
    top: calc(-1 * var(--space-2));
    animation: confettiFall 1.5s ease-out forwards;
    opacity: 0;
}

@keyframes confettiFall {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }

    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

// Position Section
.positionSection {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
}

.positionLabel {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-base-content-secondary);
    text-transform: uppercase;
    letter-spacing: var(--letter-spacing-wide);
}

.positionDisplay {
    display: flex;
    align-items: baseline;
    gap: var(--space-1);
    position: relative;
}

.positionHash {
    font-size: var(--font-size-xl);  // 28px
    font-weight: var(--font-weight-bold);
    color: var(--color-base-content-secondary);
}

.positionNumber {
    font-size: var(--font-size-4xl);  // 40px
    font-weight: var(--font-weight-bold);
    color: var(--color-base-content);
    transition: all var(--duration-normal) var(--ease-out);

    .improving & {
        animation: bounceIn var(--duration-normal) var(--ease-out);
        color: var(--color-success);
    }
}

@keyframes bounceIn {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
    }
}

.improvementBadge {
    display: flex;
    align-items: center;
    gap: var(--space-0-5);
    padding: var(--space-0-5) var(--space-2);
    background-color: var(--color-bg-success-alpha);
    color: var(--color-success);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    animation: slideInRight var(--duration-fast) var(--ease-out);

    i {
        font-size: var(--font-size-sm);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(calc(-1 * var(--space-2)));
    }

    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.totalUsers {
    font-size: var(--font-size-base);
    color: var(--color-base-content-secondary);
}

// Percentile Section
.percentileSection {
    display: flex;
    justify-content: center;
}

.percentileBadge {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-2) var(--space-4);
    background: linear-gradient(135deg, var(--color-bg-warning-alpha) 0%, oklch(from var(--color-info) l c h / 0.15) 100%);
    border: 1px solid var(--color-border-warning-default);
    border-radius: var(--radius-full);
    transition: all var(--duration-fast) var(--ease-out);

    &:hover {
        transform: translateY(calc(-1 * var(--space-0-5)));
        box-shadow: 0 var(--space-0-5) var(--space-2) var(--color-shadow-default);
    }

    i {
        font-size: var(--font-size-lg);
        color: var(--color-warning);
    }
}

.percentileText {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-base-content);
}

// Loading Indicator
.loadingIndicator {
    position: absolute;
    top: var(--space-2);
    right: var(--space-2);
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--space-5);  // 24px
    height: var(--space-5);
    color: var(--color-base-content-secondary);

    i {
        font-size: var(--font-size-lg);
        animation: spin 0.5s linear infinite;
    }
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

// Improving state animation
.improving {
    .container {
        border-color: var(--color-border-success-default);
        box-shadow: 0 0 20px var(--color-bg-success-alpha);
    }
}
