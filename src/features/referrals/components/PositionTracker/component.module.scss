@use "@/design-tokens/layout" as layout;
@use "@/design-tokens/typography" as typography;
@use "@/design-tokens/motion" as motion;
@use "@/design-tokens/border" as border;
@use "@/design-tokens/breakpoints" as breakpoints;

.root {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    overflow: hidden;
}

.container {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: layout.$spacing-05;
    padding: layout.$spacing-06;
    background-color: var(--color-surface-primary-default);
    border: 1px solid var(--color-border-primary-default);
    border-radius: border.$border-radius-large;
    transition: all motion.$duration-moderate-01 motion.$easing-productive-standard;

    @media (max-width: breakpoints.$breakpoint-md) {
        padding: layout.$spacing-05;
    }
}

// Confetti Animation
.confettiContainer {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 10;
}

.confetti {
    position: absolute;
    width: layout.$spacing-03;  // 8px, close to 10px
    height: layout.$spacing-03;
    top: calc(-1 * layout.$spacing-03);
    animation: confettiFall motion.$duration-slow-02 ease-out forwards;
    opacity: 0;
}

@keyframes confettiFall {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

// Position Section
.positionSection {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: layout.$spacing-03;
}

.positionLabel {
    font-size: typography.$font-size-sm;
    font-weight: typography.$font-weight-medium;
    color: var(--color-text-secondary-default);
    text-transform: uppercase;
    letter-spacing: typography.$letter-spacing-wide;
}

.positionDisplay {
    display: flex;
    align-items: baseline;
    gap: layout.$spacing-02;
    position: relative;
}

.positionHash {
    font-size: typography.$font-size-h3;  // 28px
    font-weight: typography.$font-weight-bold;
    color: var(--color-text-secondary-default);
}

.positionNumber {
    font-size: typography.$font-size-h1;  // 40px
    font-weight: typography.$font-weight-bold;
    color: var(--color-text-primary-default);
    transition: all motion.$duration-moderate-01 motion.$easing-productive-standard;

    .improving & {
        animation: bounceIn motion.$duration-moderate-01 motion.$easing-expressive-standard;
        color: var(--color-success-default);
    }
}

@keyframes bounceIn {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
    }
}

.improvementBadge {
    display: flex;
    align-items: center;
    gap: layout.$spacing-01;
    padding: layout.$spacing-01 layout.$spacing-03;
    background-color: var(--color-bg-success-alpha);
    color: var(--color-success-default);
    border-radius: border.$border-radius-round;
    font-size: typography.$font-size-xs;
    font-weight: typography.$font-weight-semibold;
    animation: slideInRight motion.$duration-fast-01 motion.$easing-productive-standard;

    i {
        font-size: typography.$font-size-sm;
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(calc(-1 * layout.$spacing-03));
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.totalUsers {
    font-size: typography.$font-size-md;
    color: var(--color-text-secondary-default);
}

// Percentile Section
.percentileSection {
    display: flex;
    justify-content: center;
}

.percentileBadge {
    display: flex;
    align-items: center;
    gap: layout.$spacing-02;
    padding: layout.$spacing-03 layout.$spacing-05;
    background: linear-gradient(135deg, var(--color-bg-warning-alpha) 0%, var(--color-bg-info-alpha) 100%);
    border: 1px solid var(--color-border-warning-default);
    border-radius: border.$border-radius-round;
    transition: all motion.$duration-fast-01 motion.$easing-productive-standard;

    &:hover {
        transform: translateY(calc(-1 * layout.$spacing-01));
        box-shadow: 0 layout.$spacing-01 layout.$spacing-03 var(--color-shadow-default);
    }

    i {
        font-size: typography.$font-size-lg;
        color: var(--color-warning-default);
    }
}

.percentileText {
    font-size: typography.$font-size-md;
    font-weight: typography.$font-weight-semibold;
    color: var(--color-text-primary-default);
}

// Loading Indicator
.loadingIndicator {
    position: absolute;
    top: layout.$spacing-03;
    right: layout.$spacing-03;
    display: flex;
    align-items: center;
    justify-content: center;
    width: layout.$spacing-06;  // 24px
    height: layout.$spacing-06;
    color: var(--color-icon-secondary-default);

    i {
        font-size: typography.$font-size-lg;
        animation: spin motion.$duration-moderate-02 linear infinite;
    }
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

// Improving state animation
.improving {
    .container {
        border-color: var(--color-border-success-default);
        box-shadow: 0 0 20px var(--color-bg-success-alpha);
    }
}
